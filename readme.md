
### Modbus字符指令工具
  * 目标可执行文件下载地址：
    +  https://download.csdn.net/download/thtfcccj/
  * 源代码开源地址：
    +  https://gitee.com/thtfcccj/ModbusStrCmd.git
    +  https://github.com/thtfcccj/ModbusStrCmd.git

### 功能说明
  此功具主要用于处理MODBUS协议中封装的以字符组织的数据指令
  * 支持直接编辑的单指令
  * 支持提前编辑好的批处理指令(一行行调用执行)
  * 支持接收数据日志显示，日志支持直接编辑，数据格式可选
  * 支持接收数据日志保存功能。
  * 支持不同类型的指令(在Fun.ini文件中配置)
#### 收发数据格式
  使用MODBUS RTU模式，按下述协议方式组织：
  * 发送：
   + 设备地址(软件界面指定) + 
   + 前缀(含功能码+可选固定数据,在Fun.ini文件指定) + 
   + 字符串(单指令中的输入，或批处理文件中的每一行) +
   + CRC16 组成。
  * 接收：
    + 设备地址(软件界面指定) + 
    + 前缀长度(在Fun.ini文件指定长度，此长度将忽略) + 
    + 返回的字符串(在“接收日志中展示”) +
    + CRC16 组成。 

#### 字符串格式
  * ASCII与GB2312编码,不支持其它编码格式!

#### Fun.ini配置说明
  以下为例：
  * 联动逻辑             = 66, 0x55 |  2;
  * 名称修改             = 65, 0x5a |  2;
  * 每行一种类型，编辑好后软件上将直接显示以供选择。
  * “=”前为软件上显示的功能名称 以";"结束，后可跟注解等
  * =后的“|”前，为以“功能码”开始的数据，支持十进制与十六进制，每个“,”区分，有多少个加多少个
  * =后的“|”后，为接收到的，有效字符串的前缀长度(不含设备地址)
  * 若想临时不要此功能，在最前面加“//”可注解掉。

#### ModbusStrCmd.ini配置说明
  以下带“★”标识的，为软件自已产生，不建议更改：
  * [General]
  * ComBuad=9600            //波特率:600/1200/2400/4800/9600/14400/19200/38400/56000/57600/76800/115200/128000
  * ComPar=0                //校验方式：0无(错误默认) 1奇 2偶
  * ComBit=8                //数据位：8，7，8无(错误默认)
  * ComStop=1               //停止位：1(错误默认)，2，15(1.5位停止位)
  * ComFlow=0               //流控：0关闭(错误默认)，1开启
  * ComCount=256            //软件处理的通讯口总数,如20，即COM20以内，最大256
  * EnComAutoFilter=1       //(非0时)开启COM口过滤功能，开启后在COM选择框内不会出现没有的COM口,且会增加“刷新”按钮
  * DisComAutoSel=0         //(非0时)禁止自动选择 当默认COM口失效时，未禁止时开机将自动连接至最小有效COM口上，否则关闭
  * DisCommNote=0           //(非0时)禁止通讯提示,  即在开关COM口时，不出来提示
  * WaitMs=100              //预留，等待从机响应时间,ms为单位
  * FrameSpaceMs=500        //预留，批处理时，数据帧间隔,ms为单位
  * LastCom=3               //★ 最后选择的COM口
  * LastAdr=1               //★ 最后选择的设备地址
  * LastFun=0               //★ 最后选择的(Fun.ini)对应功能
  * LastBatFile=F:/x6307\x4ee4.txt //★最后选择的批处理文件
  * LastLogFile=F:/x65e5\x5fd7.txt //★最后保存的输出日志文件
  * LogState=2              //★(非0时) 允许填充工作状态
  * LogTime=2               //★(非0时) 允许填充时间
  * LogRead=2               //★(非0时) 允许填充读字符串
  * LogEnRewrite=0          //★(非0时) 允许更改输出日志内容


